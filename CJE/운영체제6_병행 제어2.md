## __ğŸ¦ˆ Deadlock and Starvation__

ğŸ¬ **Deadlock** <br/>
ë‘˜ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì„œë¡œ ìƒëŒ€ë°©ì— ì˜í•´ ì¶©ì¡±ë  ìˆ˜ ìˆëŠ” eventë¥¼ ë¬´í•œíˆ ê¸°ë‹¤ë¦¬ëŠ” í˜„ìƒ
* ex) í”„ë¡œì„¸ìŠ¤A, Bê°€ ëª¨ë‘ 1(lock)ë¡œ ì´ˆê¸°í™” ëœ S,Qì„¸ë§ˆí¬ì–´ê°€ í•„ìš”
    * Aê°€ P(S)ë¡œ Së¥¼ ì°¨ì§€, ë™ì‹œì— Bê°€ P(Q)ë¡œ Që¥¼ ì°¨ì§€
    * ì„œë¡œ Q, Sê°€ í•„ìš”í•˜ë‹ˆê¹ ëŒ€ê¸°.. -> ë¬´í•œíˆ ëŒ€ê¸°

ğŸ¬ **Starvation**<br/>
indefinite blocking. í”„ë¡œì„¸ìŠ¤ê°€ suspend ëœ ì´ìœ ì—

## __ğŸ¦ˆ Classical Problems of Synchronization__

ğŸ¬ Bounded-Buffer Problem: ìƒì‚°ì ì†Œë¹„ì‚¬ ê³µìœ  ë²„í¼ ë¬¸ì œ
* ê³µìœ  ë²„í¼(shared data) -> ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ì ‘ê·¼
* Producer í”„ë¡œì„¸ìŠ¤: ë°ì´í„°ë¥¼ ìƒì‚°
    * empty ë²„í¼ O (ì—†ìœ¼ë©´ ê¸°ë‹¤ë¦¼) -> ê³µìœ  ë°ì´í„°ì— Lock -> empty ë²„í¼ì— ë°ì´í„° ì…ë ¥ -> Lock í’€ê¸° -> full ë²„í¼ ê°œìˆ˜ +1
* Consumer í”„ë¡œì„¸ìŠ¤: ë°ì´í„°ë¥¼ êº¼ë‚´ê°
    * full ë²„í¼ O (ì—†ìœ¼ë©´ ê¸°ë‹¤ë¦¼) -> ê³µìœ  ë°ì´í„°ì— Lock -> full ë²„í¼ì—ì„œ ë°ì´í„° êº¼ë‚´ê° -> Lock í’€ê¸° -> empty ë²„í¼ ê°œìˆ˜ +1
* Shared data: buffer ìì²´ì˜ ë°ì´í„° & buffer ì¡°ì‘ ë³€ìˆ˜(empty/full ë²„í¼ ì¹¸ì˜ ìœ„ì¹˜)
* Synchronization ë³€ìˆ˜
    * mutual exclusion(ë™ì‹œ ì ‘ê·¼ ë§‰ê¸°) - binary semaphore(lock ê±¸ê¸° ìœ„í•´ mutexë¼ëŠ” ë³€ìˆ˜ ì‚¬ìš©)
    * resource count - integer semaphore(ë‚¨ì€ full/empty ë²„í¼ ê°œìˆ˜ í‘œì‹œ)

ğŸ¬ Readers-Writers Problem: ê³µìœ  ë°ì´í„° ì½ê¸° ì“°ê¸° ë¬¸ì œ
* í•œ í”„ë¡œì„¸ìŠ¤ê°€ DB(ê³µìœ  ë°ì´í„°)ì— write ì¤‘ì¼ ë•Œ, ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ì ‘ê·¼í•˜ë©´ ì•ˆ ë¨
* readëŠ” ë™ì‹œì— ì—¬ëŸ¿ì´ ê°€ëŠ¥
* ì†”ë£¨ì…˜
    * writerê°€ DB ì ‘ê·¼ X -> ëª¨ë“  reader DB ì ‘ê·¼ O
    * writerê°€ DB ì ‘ê·¼ O -> reader ëŒ€ê¸°
    * ëŒ€ê¸°ì¤‘ì¸ reader X -> writer DB ì ‘ê·¼ O
    * readerëŠ” DBì— ì ‘ê·¼ ì¤‘ì—ë„ readerì˜ ì ‘ê·¼ì€ O
* Shared data: DB ìì²´ & readCount(DBì— ì ‘ê·¼ì¤‘ì¸ readerì˜ ìˆ˜)
* Synchronization ë³€ìˆ˜
    * mutex - ê³µìœ  ë°ì´í„°ì¸ readcount(DBì‚¬ìš©ì¤‘ì¸ readerìˆ˜)ì— ì ‘ê·¼í•˜ëŠ” ì„¸ë§ˆí¬ì–´ (mutual exclusionì„ ë³´ì¥-P(mutex)&V(mutex))
    * db - readerì™€ writerê°€ DB ìì²´ì— ì˜¬ë°”ë¥´ê²Œ ì ‘ê·¼í•˜ë„ë¡ í•˜ëŠ” ì—­í• 
* Starvation ë¬¸ì œ
    * readerê°€ ì‚¬ìš©ì¤‘ì´ë¼ì„œ writerê°€ ëŒ€ê¸° -> readerê°€ ê³„ì† ìƒˆë¡œ ë„ì°©(readcount++).. -> ëŒ€ê¸°..
    * ì‹ í˜¸ë“±ì²˜ëŸ¼ ì–´ëŠ ì •ë„ ëŠì–´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ readerì„ ëŠì–´ì£¼ëŠ” ê²ƒì´ í•„ìš”

ğŸ¬ Dining-Philosophers Problem: ì‹ì‚¬í•˜ëŠ” ì² í•™ì ë¬¸ì œ
* ì² í•™ìê°€ ë°¥ ë¨¹ëŠ” ë¬¸ì œ (-> êµ¶ì–´ì£½ìœ¼ë©´ ì•ˆ ë¨) & ìƒê°í•˜ê¸°
* Shared data: ì “ê°€ë½ 5ê°œ
* ë°¥ ë¨¹ì„ ë•Œ(í”„ë¡œì„¸ìŠ¤) - ì™¼&ì˜¤ë¥¸ìª½ ì “ê°€ë½ 2ê°œ í•„ìš”
    * ìê¸°ê°€ eat()í•˜ê¸° ì „ê¹Œì§€ëŠ” ì “ê°€ë½ì„ í¬ê¸°í•˜ì§€ ì•ŠìŒ -> Deadlock
```
do{
    P(chopstick[i]);    // ì™¼ìª½ ì “ê°€ë½ ë¨¼ì €
    P(chopstick[(i+1)%5]);  // ì˜¤ë¥¸ìª½ ì “ê°€ë½
    ...
    eat();
    ...
    V(chopstick[i]);
    V(chopstick[(i+1)%5]);
    ...
    think();
    ...
} while(1);
```
<img src="https://user-images.githubusercontent.com/86587287/196862283-e80246ee-4222-449a-8618-91924edcec24.png" width=300px>

* ì†”ë£¨ì…˜
    1) 4ëª…ì˜ ì² í•™ìë§Œ ì‹íƒì— ì•‰íˆì
    2) ì “ê°€ë½ 2ê°œë¥¼ ëª¨ë‘ ì¡ì„ ìˆ˜ ìˆì„ ë•Œë§Œ ì¡ê²Œ í•˜ì
    3) ì§ìˆ˜(í™€ìˆ˜)ì² í•™ìëŠ” ì™¼ìª½(ì˜¤ë¥¸ìª½) ì “ê°€ë½ ë¨¼ì € ì§‘ê²Œ í•˜ì

## __ğŸ¦ˆ Monitor__

ë™ì‹œì— ìˆ˜í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì‚¬ì´ì—ì„œ abstract data typeì˜ **ì•ˆì „í•œ ê³µìœ ë¥¼ ë³´ì¥**í•˜ê¸° ìœ„í•´ high-level synchronization construct

ì„¸ë§ˆí¬ì–´ì™€ì˜ ì°¨ì´ì 
* ì„¸ë§ˆí¬ì–´ëŠ” ë‚¨ì€ ìì›ì˜ ê°œìˆ˜ë¥¼ ì›ìì ìœ¼ë¡œ ê³„ì‚°í•˜ëŠ” ì—°ì‚°ë§Œ ì œê³µ (ì‹¤ì œ ë™ê¸°í™” ë¬¸ì œëŠ” í”„ë¡œê·¸ë˜ë¨¸ê°€ ì±…ì„ (ë½ ê±¸ê³  í’€ê³ ))
* ëª¨ë‹ˆí„°ëŠ” ê³µìœ ë°ì´í„°ì— ëŒ€í•œ ì ‘ê·¼ì„ ëª¨ë‹ˆí„° ì•ˆì— ì •ì˜ëœ í•¨ìˆ˜ë¥¼ í†µí•´ì„œë§Œ (í”„ë¡œê·¸ë˜ë¨¸ëŠ” ë½ í•„ìš” X, ëª¨ë‹ˆí„° ì•ˆì˜ ì½”ë“œë§Œ ì´ìš©í•˜ë©´ ë¨)

ëª¨ë‹ˆí„°ê°€ ì•Œì•„ì„œ ê³µìœ  ë°ì´í„°ì˜ ë™ì‹œ ì ‘ê·¼ì„ ë§‰ìŒ
* í•œ í”„ë¡œì„¸ìŠ¤ê°€ shared dataë¥¼ ì‚¬ìš©ì¤‘ -> queueì— ëŒ€ê¸°

í”„ë¡œì„¸ìŠ¤ê°€ ëª¨ë‹ˆí„° ì•ˆì—ì„œ ê¸°ë‹¤ë¦´ ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´ **condition variable** ì‚¬ìš©
* shared dataì˜ ì—¬ë¶„ì´ ì—†ì„ ë•Œ -> íì— ì¤„ì„œì„œ ì ë“¤ê¸°(blocked)
* ìì›ì˜ ê°œìˆ˜ ì„¸ì§€ ì•ŠìŒ
* wait() - ì ë“¤ê¸°(ìì›ì˜ ì—¬ë¶„ X)
* signal() - ê¹¨ìš°ê¸°(ìì›ì˜ ì—¬ë¶„ì´ ìƒê¹€)

Bounded-Buffer Problem
* í”„ë¡œê·¸ë˜ë¨¸ëŠ” ê³µìœ  ë°ì´í„°ë¥¼ ì ‘ê·¼í•  ë•Œì˜ ë¬¸ì œë¥¼ ìƒê°í•  í•„ìš” X (ë½ X)
* ëª¨ë‹ˆí„° ì•ˆì—ì„œ í™œì„±í™”ëœ í”„ë¡œì„¸ìŠ¤ëŠ” 1ê°œë¡œ í•œì • (ë‚˜ë¨¸ì§€ëŠ” blockedë¡œ íì—ì„œ ê¸°ë‹¤ë¦¼)

Dining-Philosophers Problem
* ì “ê°€ë½ 2ê°œë¥¼ ëª¨ë‘ ì¡ì„ ìˆ˜ ìˆì„ ë•Œë§Œ ì¡ê²Œ í•˜ì
* condition variable - ì–‘ìª½ë‹¤ ì¡ì„ ìˆ˜ ìˆëŠ” ìƒíƒœ
* ì•ˆ ë˜ë©´ -> wait() (ì¬ìš°ê¸°)
